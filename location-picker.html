<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ | Wash Go</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding-bottom: 200px;
        }
        
        .map-header {
            background: white;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }
        
        #map {
            height: 55vh;
            width: 100%;
            margin-top: 60px;
            z-index: 1;
        }
        
        .location-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 25px 20px;
            border-radius: 30px 30px 0 0;
            box-shadow: 0 -10px 30px rgba(0, 0, 0, 0.1);
            z-index: 1001;
        }
        
        .address-box {
            background: #f1f3f5;
            padding: 12px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            border: 1px solid #e9ecef;
        }
        
        .btn-confirm {
            border-radius: 50px;
            padding: 14px;
            font-weight: 800;
            background: #007bff;
            border: none;
            color: white;
            width: 100%;
        }
        
        .btn-back-nav {
            background: none;
            border: none;
            font-weight: bold;
            color: #333;
            display: flex;
            align-items: center;
        }
        /* Modal Custom Styling */
        
        .modal-content {
            border-radius: 30px;
            border: none;
            overflow: hidden;
        }
        
        .modal-body {
            padding: 40px 20px;
        }
        
        .icon-circle {
            width: 80px;
            height: 80px;
            background: #e7f1ff;
            color: #007bff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 2rem;
        }
    </style>
</head>

<body>

    <div class="map-header d-flex justify-content-between align-items-center">
        <button onclick="window.location.href='station-details.html'" class="btn-back-nav">
            <i class="fas fa-arrow-right ms-2 text-primary"></i> Ø±Ø¬ÙˆØ¹
        </button>
        <h6 class="fw-bold mb-0">ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</h6>
        <div style="width: 40px;"></div>
    </div>

    <div id="map"></div>

    <div class="location-footer">
        <div class="container p-0 text-end">
            <h6 class="fw-bold mb-2">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ù…Ø®ØªØ§Ø±</h6>
            <div class="address-box">
                <i class="fas fa-map-marker-alt text-primary ms-3 fs-5"></i>
                <span id="address-text" class="small fw-bold text-dark">Ø§Ù†Ù‚Ø±ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ù„ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ÙƒÙ</span>
            </div>
            <div class="alert alert-warning py-2 mb-3 border-0 rounded-4 shadow-sm text-end d-flex align-items-center justify-content-start">
                <i class="fas fa-info-circle ms-2"></i>
                <span class="fw-bold small">Ù…Ù„Ø§Ø­Ø¸Ø©: Ø®Ø¯Ù…Ø© Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ù…Ù†Ø²Ù„ÙŠ ØªØªØ·Ù„Ø¨ Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ø§Ø­Ù‚Ø§Ù‹.</span>
            </div>
            <button onclick="confirmLocation()" class="btn btn-primary btn-confirm shadow">
                ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ù„Ù…ØªØ§Ø¨Ø¹Ø© <i class="fas fa-chevron-left ms-2"></i>
            </button>
        </div>
    </div>

    <div class="modal fade" id="successModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content shadow-lg">
                <div class="modal-body text-center">
                    <div class="icon-circle shadow-sm">
                        <i class="fas fa-map-check"></i>
                    </div>
                    <h4 class="fw-bold mb-3">ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹! ğŸ“</h4>
                    <p class="text-muted mb-4">ÙŠØ§ Ù‡Ù†Ø¯ØŒ Ø·Ù„Ø¨ÙƒÙ Ø§Ù„Ø¢Ù† Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ù…Ø­Ø·Ø©. Ø³Ù†Ù‚ÙˆÙ… Ø¨Ø¥Ø¨Ù„Ø§ØºÙƒÙ ÙÙˆØ± Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø·Ù„Ø¨ Ù„ØªØªÙ…ÙƒÙ†ÙŠ Ù…Ù† Ø§Ù„Ø¯ÙØ¹.</p>
                    <button onclick="redirectToSuccess()" class="btn btn-primary rounded-pill px-5 fw-bold">Ø­Ø³Ù†Ø§Ù‹ØŒ ÙÙ‡Ù…Øª</button>
                </div>
            </div>
        </div>
    </div>



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // 1. Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        const map = L.map('map').setView([31.9539, 35.9106], 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        let marker = L.marker([31.9539, 35.9106], {
            draggable: true
        }).addTo(map);

        function updateText(lat, lng) {
            document.getElementById('address-text').innerText = `ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ¯: (${lat.toFixed(4)}, ${lng.toFixed(4)})`;
        }

        marker.on('dragend', () => updateText(marker.getLatLng().lat, marker.getLatLng().lng));
        map.on('click', (e) => {
            marker.setLatLng(e.latlng);
            updateText(e.latlng.lat, e.latlng.lng);
        });

        // 2. Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯ (ÙØªØ­ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„)
        function confirmLocation() {
            localStorage.setItem('user_location_set', 'true');
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
            var myModal = new bootstrap.Modal(document.getElementById('successModal'));
            myModal.show();
        }

        // 3. Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¨Ø¹Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
        function redirectToSuccess() {
            window.location.href = 'order-success.html';
        }
    </script>
</body>

</html>